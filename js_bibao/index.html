<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>闭包和高阶函数</title>
	</head>
	<body>
		<button id="execute">点击我执行命令</button>
		<button id="undo">点击我执行命令</button>
	</body>
	<script>
		var Tv = {
			open:function(){
				console.log('打开电视机');
			},
			close:function(){
				console.log('关上电视机');
			}
		};
		var OpenTvCommand = function(receiver){
			this.receiver = receiver;
		};
		
		OpenTvCommand.prototype.execute = function(){
			this.receiver.open();
		};
		
		OpenTvCommand.prototype.undo = function(){
			this.receiver.close();
		};
		
		var setCommond = function(commond){
			document.getElementById('execute').onclick =function(){
				commond.execute();
			}
			document.getElementById('undo').onclick = function(){
				commond.undo();
			}
		}
		setCommond(new OpenTvCommand(Tv));
		
		
		//变量的作用域
		
//		var a =1;
//		var func1 = function(){
//			var b = 2;
//			var func2 = function(){
//				var c=3;
//				alert(b);
//				alert(a);
//			}
//			func2();
//			alert(c);
//		}
//		func1();

//		变量的生存周期
//		var func = function(){
//			var a = 1;
//			alert(a);
//		};
//		func();

//		var func = function(){
//			var a = 1;
//			return function(){
//				a++;
//				alert(a);
//			}
//		};
//		func()();
//		var f = func();
//		f();
//		f();
//		f();
//		f();
//		f();

//		var nodes = document.getElementsByTagName('div');
//		
//		for (var i =0,len = nodes.length;i<len;i++) {
//			(function(i){
//				nodes[i].onclick = function(){
//					console.log(i);
//				}
//			})(i)
//		}
		
		
//		var Type = {};
//		for(var i=0,type;type=['String','Array','Number'][i++];){
//			(function(type){
//				Type['is'+type] = function(obj){
//					return Object.prototype.toString.call(obj) === '[object'+type+']';
//				}
//			})(type)
//		};
//		Type.isArray([]);
//		Type.isString('str');

//		var mult = function(){
//			var a = 1;
//			for (var i =0,l = arguments.length;i<l;i++) {
//				a = a*arguments[i];
//			}
//			return a;
//		};
//		
//		var cache = {};
//		var mult = function(){
//			var args = Array.prototype.join.call(arguments,',');
//			if(cache[args]){
//				return cache[args];
//			}
//			var a = 1;
//			for (var i =0,l = arguments.length;i<l;i++) {
//				a = a*arguments[i];
//			}
//			return cache[args] = a;
//			return a;
//		};
//		
//		var mult = (function(){
//			var cache = {};
//			return function(){
//				var args = Array.prototype.join.call(arguments,',');
//				if(args in cache){
//					return cache[args];
//				}
//				var a =1;
//				for(var i = 0,l=arguments.length;i<l;i++){
//					a = a*arguments[i];
//				}
//				return cache[args] = a;
//			}
//		})();
//		
//		var mult = (function(){
//			var cache = {};
//			var calculate = function(){ //封闭calculate函数
//				var a =1;
//				for (var i =0,l=arguments.length;i<l;i++) {
//					a = a*arguments[i];
//				}
//				return a;
//			};
//			
//			return function(){
//				var args = Array.prototype.join.call(arguments,',');
//				if(args in cache){
//					return cache[args];
//				}
//				return cache[args] = calculate.apply(null,arguments);
//			}
//			
//		})();

//		var report = function(src){
//			var img = new Image();
//			img.src=src;
//		};
//		report('http://ihzen.com/demos/js_lazyloadimg/img/1.jpg');
//		
//		var report = (function(){
//			var imgs = [];
//			return function(src){
//				var img = new Image();
//				imgs.push(img);
//				img.src=src;
//			}
//		})();
		
//		闭包写法
//		var extent = function(){
//			var value = 0;
//			return {
//				call:function(){
//					value ++ ;
//					console.log(value);
//				}
//			}
//		};
//		var extent = extent();
//		extent.call();
//		extent.call();
//		extent.call();
//		
////		面向对象写法
//		var extent = {
//			value:0,
//			call:function(){
//				this.value++;
//				console.log(this.value);
//			}
//		};
//		extent.call();
//		extent.call();
//		extent.call();
//		
//		var Extent = function(){
//			this.value =0;
//		};
//		
//		Extent.prototype.call = function(){
//			this.value++;
//			console.log(this.value);
//		};
//		
//		var extent = new Extent();
//		extent.call();
//		extent.call();
//		extent.call();
		
	</script>
</html>
