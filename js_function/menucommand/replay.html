<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>撤销和重做</title>
	</head>
	<body>
		<button id="replay">播放录像</button>
	</body>
	<script>
		var Ryu = {
			attack: function(){
				console.log('攻击');
			},
			defense: function(){
				console.log('防御');
			},
			jump: function(){
				console.log('跳跃');
			},
			crouch: function(){
				console.log('蹲下');
			}
		};
		
		var makeCommand = function(receiver, state){
			return function(){
				receiver[ state ]();
			}
		};
		
		var commands = {
			'119': 'jump',
			'115': 'crouch',
			'97': 'defense',
			'100': 'attack'
		};
		
		var commandStack = [];    //保存命令的堆栈
		
		document.onkeypress = function(ev){
			var keyCode = ev.keyCode,
				command = makeCommand(Ryu, commands[ keyCode ]);
			if(command){
				command();  //执行命令
				commandStack.push(command);  //将刚刚执行过的命令保存进堆栈
			}
		};
		
		document.getElementById('replay').onclick = function(){  //点击播放录像
			var command;
			while( command = commandStack.shift()){  //从堆栈里依次取出命令并执行
				command();
			}
		};
	</script>
</html>
